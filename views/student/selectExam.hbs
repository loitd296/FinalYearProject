{{> header}}
<style>
  .content {
    border: 2px solid #ccc;
    padding: 20px;
  }
</style>

<div class="content">
  <div class="card-group">
    <div class="row row-cols-1 row-cols-md-5">
      {{#each exams}}
      <div class="col mb-4 stack">
        <div class="card-take-exam bg-primary text-white">
          <div class="card-body">
            <h5 class="card-title">{{this.name}}</h5> <br>
            <p class="card-text">
              <i class="fas fa-book"></i> <strong class="variable-name">Subject:</strong> <span class="variable-value">{{this.subject.name}}</span><br>
                <hr>
                <i class="fas fa-calendar-alt"></i> <strong class="variable-name">Academic Year:</strong> <span class="variable-value">{{this.academicYear.name}}</span><br>
                <hr>
                <i class="fas fa-calendar"></i> <strong class="variable-name">Academic Term:</strong> <span class="variable-value">{{this.academicTerm.name}}</span><br>
                <hr>
                <i class="fas fa-users"></i> <strong class="variable-name">Class Level:</strong> <span class="variable-value">{{this.classLevel.name}}</span><br>
                <hr>
                <i class="fas fa-file-alt"></i> <strong class="variable-name">Exam Type:</strong> <span class="variable-value">{{this.examType}}</span><br>
                <hr>
                <i class="fas fa-graduation-cap"></i> <strong class="variable-name">Program:</strong> <span class="variable-value">{{this.program.name}}</span><br>
            </p>
            <div class="form-group">
              <label for="accessKey">Access Key:</label>
              <input type="text" class="form-control" id="accessKey_{{this._id}}" placeholder="Enter access key">
            </div>
            <div class="text-center">
              <button class="btn btn-light" onclick="validateAccessKey('{{this._id}}', '{{this.accessKey}}')">Take Exam</button>
            </div>
          </div>
        </div>
      </div>
      {{/each}}
    </div>
  </div>
</div>

{{> footer}}

<script>
  function validateAccessKey(examId, accessKey) {
    const accessKeyInput = document.getElementById('accessKey_' + examId);
    const enteredAccessKey = accessKeyInput.value;

    if (enteredAccessKey === accessKey) {
    window.location.href = '/student/write/' + examId;
    alert('Correct.');

    } else {  
      alert('Incorrect access key. Please try again.');
      accessKeyInput.value = '';
    }
  }
</script>
